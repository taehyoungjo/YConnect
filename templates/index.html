{% extends "layout.html" %}

{% block title %}
    Index
{% endblock %}

{% block main %}
<form action="/search" method="get">
    <div class="form-group">
        <input autocomplete="off" autofocus class="form-control" name="name" placeholder="Name" type="text">
    </div>
    <div class="form-group">
        <select autocomplete="off" autofocus class="form-control" name="major" placeholder="Major">
          <option value="" selected disabled>Major</option>
          {% for id in majors %}
          <option value="{{id["id"]}}">{{ id["id"] }}</option>
          {% endfor %}
        </select>
      </div>
</form>

<ul id="results"></ul>

<script>

    let name = document.querySelector('input');
    let major = document.querySelector('select');
    name.onkeyup = function() {
        $.get('/search?name=' + name.value + '&major=' + major.value , function(data) {
            let html = '';
            for (profile of data) {
                html += "<li>" + profile["name"] + ', ' + profile["major"] + ', ' + profile["year"] + "</li>";
            }
            document.getElementById("results").innerHTML = html;
        });
    };

</script>
{% endblock %}